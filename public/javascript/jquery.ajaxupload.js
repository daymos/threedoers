!function(){var a=function(){},b=window.console=window.console||{};b.log||(b.log=a)}(),function(a){"use strict";a.ajaxUpload||(a.ajaxUploadSettings={onprogress:function(){console.log("Ajax Upload progress")},onabort:function(){console.log("Ajax Upload abort")},onerror:function(a){console.log("Ajax Upload error"),console.log(a)},onload:function(){console.log("Ajax Upload load")},name:"uploads[]"},a.ajaxUploadSerializeFiles=function(b){for(var c=[],d=a(b).attr("name"),e=0,f=b.files.length;f>e;e++)c.push({name:d,value:b.files[e]});return c},a.ajaxUploadToFormData=function(a,b){for(var c=b||new FormData,d=0,e=a.length;e>d;d++)c.append(a[d].name,a[d].value);return c},a.ajaxUploadExtractData=function(b,c){if(!b||b instanceof FormData)return b;var d=a.ajaxUploadExtractData(c)||new FormData;if("string"==typeof b||b instanceof jQuery){var e=[];a(b).each(function(){a.merge(e,a.ajaxUploadSerializeFiles(this))}),b=e}else if(b instanceof FileList){for(var e=[],f=0,g=b.length;g>f;f++)e.push({name:a.ajaxUploadSettings.name,value:b[f]});b=e}else if("object"==typeof b&&!a.isArray(b)){var h=[];for(name in b)h.push({name:name,value:b[name]});b=h}return a.ajaxUploadToFormData(b,d)},a.ajaxUpload=function(b){var c=jQuery.extend(!0,{},a.ajaxUploadSettings,b),d=a.ajaxUploadExtractData(c.data);c.data=null;var e={processData:!1,type:"POST",beforeSend:function(a,c){c.xhr=function(){var a=new window.XMLHttpRequest;return a.upload.onprogress=c.onprogress.bind(this),a.upload.onabort=c.onabort.bind(this),a.upload.onerror=c.onerror.bind(this),a.upload.onload=c.onload.bind(this),a},c.data=d,b.beforeSend&&b.beforeSend.call(this,a,c)}};return c=jQuery.extend(!0,{},c,e),c.contentType&&delete c.contentType,a.ajax(c)},a.fn.ajaxUpload=function(b){return this.each(function(){var c=jQuery.extend(!0,{},b),d=a(this).serializeArray();a("input:file",this).each(function(){a.merge(d,a.ajaxUploadSerializeFiles(this))}),c.data=a.ajaxUploadExtractData(d,c.data),a.ajaxUpload(c)})},a.ajaxUploadPost=function(b,c,d,e){return jQuery.isFunction(c)&&(e=e||d,d=c,c={}),a.ajaxUpload({type:"POST",url:b,data:c,success:d,dataType:e})},a.ajaxUploadPrompt=function(b){var c=a.Deferred(),d={success:function(){b.success&&b.success.apply(this,arguments),g.remove()}},e=jQuery.extend(!0,{},b,d),f="ajaxupload"+Date.now(),g=a('<form method="post" enctype="multipart/form-data" />').appendTo("body");g.attr("action",e.url),g.attr("target",f),g.css({position:"relative",top:-1e3,left:-1e3,opacity:0}),g.submit(function(){});var h=a('<input type="file" />').appendTo(g);return h.attr("name",a.ajaxUploadSettings.name),b.accept&&h.attr("accept",b.accept),b.multiple&&h.attr("multiple","multiple"),h.change(function(){return this.files.length?(e.data||(e.data={}),e.files=this.files,e.data=a.ajaxUploadExtractData(e.data,a.ajaxUploadSerializeFiles(this)),a.ajaxUpload(e).promise(c),void 0):!1}),h.click(),c},a.fn.ajaxUploadPrompt=function(b){return this.click(function(){a(this).trigger("ajaxUploadPrompt",a.ajaxUploadPrompt(b))})},a.fn.ajaxUploadDrop=function(b){return this.each(function(){var c=a(this);c.on("dragenter.ajaxUpload",function(a){a.stopPropagation(),a.preventDefault(),c.addClass("dragover")}).on("dragover.ajaxUpload",function(a){a.stopPropagation(),a.preventDefault(),c.addClass("dragover")}).on("dragleave.ajaxUpload",function(){c.removeClass("dragover")}).on("drop.ajaxUpload",function(d){d.stopPropagation(),d.preventDefault();var e=d.originalEvent.dataTransfer,f=e.files,g=jQuery.extend(!0,{},b);g.data=a.ajaxUploadExtractData(f,g.data),g.files=f,c.trigger("ajaxUploadDrop",a.ajaxUpload(g)),c.removeClass("dragover")})})})}(jQuery);
